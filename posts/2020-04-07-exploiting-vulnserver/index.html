<!doctype html><html lang=en><meta charset=utf-8>
<meta name=viewport content="width=device-width">
<title>Exploiting Vulnserver! | Henry Post</title>
<meta name=generator content="Hugo Eureka 0.8.0">
<link rel=stylesheet href=/css/eureka.min.css>
<script defer src=/js/eureka.min.js></script>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link rel=preload href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap" as=style onload="this.onload=null,this.rel='stylesheet'">
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/styles/solarized-light.min.css media=print onload="this.media='all',this.onload=null" crossorigin>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/highlight.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/languages/dart.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/js/all.min.js integrity="sha256-uNYoXefWRqv+PsIF/OflNmwtKM4lStn9yrz2gVl6ymo=" crossorigin></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X media=print onload="this.media='all',this.onload=null" crossorigin>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script>
<script defer src=https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js integrity="sha256-Zmpaaj+GXFsPF5WdPArSrnW3b30dovldeKsW00xBVwE=" crossorigin></script>
<link rel=icon type=image/png sizes=32x32 href=/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_32x32_fill_box_center_3.png>
<link rel=apple-touch-icon sizes=180x180 href=/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_180x180_fill_box_center_3.png>
<meta name=description content="My work/code View my work/code for this blog post at:
https://github.com/HenryFBP/VagrantPackerFiles/tree/e6b73090ed23bda867f36a7f23951da6a54b55b6
The course As part of on-the-job training, I got the chance to take a really nice course on UDemy called &lsquo;Ethical Hacking & Bug Hunting: Buffer Overflow For Beginners&rsquo; by Eslam Medhat.
https://www.udemy.com/course/buffer-overflow-course-exploit-development/
It uses Kali and Windows VMs that communicate with eachother in order to perform DLL injection that leads to a reverse shell being opened.
As someone who has never exploited this vulnerability before, this course gave me an intimate look into exactly how these attacks occur and how to craft one from scratch, provided you have the binary of the exploitable program.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"/posts/"},{"@type":"ListItem","position":2,"name":"Exploiting Vulnserver!","item":"/posts/2020-04-07-exploiting-vulnserver/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/2020-04-07-exploiting-vulnserver/"},"headline":"Exploiting Vulnserver! | Henry Post","datePublished":"2020-04-07T13:30:00-05:00","dateModified":"2020-04-07T13:30:00-05:00","wordCount":1305,"publisher":{"@type":"Person","name":"C. Wang","logo":{"@type":"ImageObject","url":"/images/icon.png"}},"description":"My work\/code View my work\/code for this blog post at:\nhttps:\/\/github.com\/HenryFBP\/VagrantPackerFiles\/tree\/e6b73090ed23bda867f36a7f23951da6a54b55b6\nThe course As part of on-the-job training, I got the chance to take a really nice course on UDemy called \u0026lsquo;Ethical Hacking \u0026amp; Bug Hunting: Buffer Overflow For Beginners\u0026rsquo; by Eslam Medhat.\nhttps:\/\/www.udemy.com\/course\/buffer-overflow-course-exploit-development\/\nIt uses Kali and Windows VMs that communicate with eachother in order to perform DLL injection that leads to a reverse shell being opened.\nAs someone who has never exploited this vulnerability before, this course gave me an intimate look into exactly how these attacks occur and how to craft one from scratch, provided you have the binary of the exploitable program."}</script><meta property="og:title" content="Exploiting Vulnserver! | Henry Post">
<meta property="og:type" content="article">
<meta property="og:image" content="/images/icon.png">
<meta property="og:url" content="/posts/2020-04-07-exploiting-vulnserver/">
<meta property="og:description" content="My work/code View my work/code for this blog post at:
https://github.com/HenryFBP/VagrantPackerFiles/tree/e6b73090ed23bda867f36a7f23951da6a54b55b6
The course As part of on-the-job training, I got the chance to take a really nice course on UDemy called &lsquo;Ethical Hacking & Bug Hunting: Buffer Overflow For Beginners&rsquo; by Eslam Medhat.
https://www.udemy.com/course/buffer-overflow-course-exploit-development/
It uses Kali and Windows VMs that communicate with eachother in order to perform DLL injection that leads to a reverse shell being opened.
As someone who has never exploited this vulnerability before, this course gave me an intimate look into exactly how these attacks occur and how to craft one from scratch, provided you have the binary of the exploitable program.">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="Henry Post">
<meta property="article:published_time" content="2020-04-07T13:30:00-05:00">
<meta property="article:modified_time" content="2020-04-07T13:30:00-05:00">
<meta property="article:section" content="posts">
<body class="flex flex-col min-h-screen">
<header class="fixed flex items-center w-full min-h-16 pl-scrollbar z-50 bg-secondary-bg shadow-sm">
<div class="w-full max-w-screen-xl mx-auto"><script>let storageColorScheme=localStorage.getItem("lightDarkMode");((storageColorScheme=='Auto'||storageColorScheme==null)&&window.matchMedia("(prefers-color-scheme: dark)").matches||storageColorScheme=="Dark")&&document.getElementsByTagName('html')[0].classList.add('dark')</script>
<nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0">
<a href=/ class="mr-6 text-primary-text text-xl font-bold">Henry Post</a>
<button id=navbar-btn class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
<i class="fas fa-bars"></i>
</button>
<div id=target class="hidden block md:flex md:flex-grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20">
<div class="md:flex md:h-16 text-sm md:flex-grow pb-4 md:pb-0 border-b md:border-b-0">
<a href=/about-site/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">About Site</a>
<a href=/contact/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">Contact</a>
<a href=/posts/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 selected-menu-item mr-4">Posts</a>
<a href=/hobbies/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">Hobbies</a>
<a href=/projects/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">Projects</a>
<a href=/resume/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">Resume</a>
<a href=/skills/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">Skills</a>
<a href=/certifications/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">Certifications</a>
<a href=/why-me/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">Why me?</a>
</div>
<div class=flex>
<div class="relative pt-4 md:pt-0">
<div class="cursor-pointer hover:text-eureka" id=lightDarkMode>
<i class="fas fa-adjust"></i>
</div>
<div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id=is-open>
</div>
<div class="absolute flex flex-col left-0 md:left-auto right-auto md:right-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40" id=lightDarkOptions>
<span class="px-4 py-1 hover:text-eureka" name=Light>Light</span>
<span class="px-4 py-1 hover:text-eureka" name=Dark>Dark</span>
<span class="px-4 py-1 hover:text-eureka" name=Auto>Auto</span>
</div>
</div>
</div>
</div>
<div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id=is-open-mobile>
</div>
</nav>
<script>let element=document.getElementById('lightDarkMode');storageColorScheme==null||storageColorScheme=='Auto'?document.addEventListener('DOMContentLoaded',()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change',switchDarkMode)}):storageColorScheme=="Light"?(element.firstElementChild.classList.remove('fa-adjust'),element.firstElementChild.setAttribute("data-icon",'sun'),element.firstElementChild.classList.add('fa-sun')):storageColorScheme=="Dark"&&(element.firstElementChild.classList.remove('fa-adjust'),element.firstElementChild.setAttribute("data-icon",'moon'),element.firstElementChild.classList.add('fa-moon')),document.addEventListener('DOMContentLoaded',()=>{getcolorscheme(),switchBurger()})</script>
</div>
</header>
<main class="flex-grow pt-16">
<div class=pl-scrollbar>
<div class="w-full max-w-screen-xl lg:px-4 xl:px-8 mx-auto">
<div class="grid grid-cols-2 lg:grid-cols-8 gap-4 lg:pt-12">
<div class="col-span-2 lg:col-span-6 bg-secondary-bg rounded px-6 py-8">
<h1 class="font-bold text-3xl text-primary-text">Exploiting Vulnserver!</h1>
<div class="flex flex-wrap flex-row items-center mt-2 text-tertiary-text">
<div class="mr-6 my-2">
<i class="fas fa-calendar mr-1"></i>
<span>2020-04-07</span>
</div>
<div class="mr-6 my-2">
<i class="fas fa-clock mr-1"></i>
<span>7 min read</span>
</div>
<div class="mr-6 my-2">
<i class="fas fa-folder mr-1"></i>
<a href=/categories/security/ class=hover:text-eureka>security</a>
<span>, </span>
<a href=/categories/hacking/ class=hover:text-eureka>hacking</a>
<span>, </span>
<a href=/categories/programming/ class=hover:text-eureka>programming</a>
</div>
</div>
<div class=content>
<h2 id=my-workcode>My work/code</h2>
<p>View my work/code for this blog post at:</p>
<p><a href=https://github.com/HenryFBP/VagrantPackerFiles/tree/e6b73090ed23bda867f36a7f23951da6a54b55b6>https://github.com/HenryFBP/VagrantPackerFiles/tree/e6b73090ed23bda867f36a7f23951da6a54b55b6</a></p>
<h2 id=the-course>The course</h2>
<p>As part of on-the-job training, I got the chance to take a really nice course on UDemy called &lsquo;Ethical Hacking & Bug
Hunting: Buffer Overflow For Beginners&rsquo; by Eslam Medhat.</p>
<p><a href=https://www.udemy.com/course/buffer-overflow-course-exploit-development/>https://www.udemy.com/course/buffer-overflow-course-exploit-development/</a></p>
<p>It uses Kali and Windows VMs that communicate with eachother in order to perform DLL injection that leads to a reverse
shell being opened.</p>
<p>As someone who has never exploited this vulnerability before, this course gave me an intimate look into exactly how
these attacks occur and how to craft one from scratch, provided you have the binary of the exploitable program.</p>
<h2 id=the-tools>The tools</h2>
<ul>
<li><a href=https://github.com/HenryFBP/VagrantPackerFiles/tree/master/vagrant/kali>Kali VM</a>
<ul>
<li>Metasploit Framework
<ul>
<li>Used for creating payloads like reverse shells</li>
<li>pattern_create.rb
<ul>
<li>Used to create a pattern (<code>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1</code> &mldr;) that is
unique every 3 bytes to determine where data is injected into a buffer if you are only able to see 3-4 bytes,
like in CPU registers</li>
<li>This is useful when attempting to determine exactly when a buffer begins to overflow into the stack.</li>
</ul>
</li>
<li>pattern_offset.rb
<ul>
<li>Used to identify a sub-pattern to a position (i.e. <code>a1A</code> would be position 3)</li>
</ul>
</li>
</ul>
</li>
<li>NetCat / nc
<ul>
<li>Used to poke simple TCP programs like vulnserver to see if they expose vulnerable functionality.</li>
</ul>
</li>
<li>spike / tcp_send_packet
<ul>
<li>Used to fuzz inputs to TCP programs, to see what causes a server to crash or do other interesting things&mldr;</li>
</ul>
</li>
<li>Python 2
<ul>
<li>Used to send our payload, concatenate our buffer overflow buf with the payload, print things nicely, etc&mldr;</li>
</ul>
</li>
</ul>
</li>
<li><a href=https://github.com/HenryFBP/VagrantPackerFiles/tree/master/vagrant/windows-vulnerable>Windows VM</a>
<ul>
<li>vulnserver
<ul>
<li>The star of the show! Some odd TCP server that&rsquo;s very vulnerable.</li>
<li>Loads a DLL called essfunc.dll with no memory protections.</li>
</ul>
</li>
<li>ImmunityDebugger
<ul>
<li>Used to debug Windows binary programs.</li>
<li>Break on specific memory locations being executed.</li>
<li>Inspect CPU registers and go to memory locations to see if a payload has been injected or not.</li>
<li><a href=https://github.com/corelan/mona>mona</a>
<ul>
<li>An extension for ImmunityDebugger.</li>
<li>Search for loaded DLLs and display their memory protections</li>
<li>??? Much more. We did not use other functionality of mona in the lab.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=setup>Setup</h2>
<ol>
<li>
<p>Set up a windows machine Use a VM or segregate the windows machine as this server allows attackers
to gain admin access remotely.</p>
<ol>
<li>
<p>Download <a href=https://github.com/stephenbradshaw/vulnserver>vulnserver</a>.</p>
</li>
<li>
<p>Download <a href=https://github.com/kbandla/ImmunityDebugger>Immunity Debugger</a>.</p>
</li>
</ol>
</li>
<li>
<p>Set up Kali Linux or any other linux distro with the tools listed above.</p>
</li>
<li>
<p>Make sure the VMs can communicate. Windows does not respond to pings AFAIK.</p>
</li>
</ol>
<h2 id=the-research>The research</h2>
<h3 id=netcat>NetCat</h3>
<p>I ran NetCat against the windows vulnserver and was greeted with a prompt. vulnserver is a simple application that uses
TCP TELNET-style communications that are ended with newlines, so netcat was able to easily communicate with it.</p>
<p><img src=/images/2020-04-07-exploiting-vulnserver/nc-to-vulnserver.png alt="In nc on Kali "></p>
<p><img src=/images/2020-04-07-exploiting-vulnserver/windows-vs.png alt="In vulnserver on Windows"></p>
<h3 id=spike>Spike</h3>
<p>I used spike to see what command would cause the server to crash. Spike is a TCP fuzzer.</p>
<p>I only tested TRUN as the guide spared me the tedium of testing all of the other commands.</p>
<p>command.spk:</p>
<pre><code class=language-c>s_readline();
s_string(&quot;TRUN &quot;);
s_string_variable(&quot;0&quot;);
</code></pre>
<p>This file contains c code that SPIKE uses to fuzz packets that are sent to the server.</p>
<p>You can perform the fuzzing like this:</p>
<pre><code>generic_send_tcp 192.168.33.16 9999 command.spk 0 0
</code></pre>
<p>Before you do this, make sure that:</p>
<ol>
<li>
<p>vulnserver is actually running. Keep in mind that this command will crash it.</p>
</li>
<li>
<p>You&rsquo;re recording the packets sent to vulnserver with Wireshark or <code>tcpdump</code> or another tool.
Alternatively you can attach Immunity Debugger to vulnserver and inspect the registers when it crashes.
This is important to craft the payload later.</p>
</li>
</ol>
<h4 id=tcpdump-to-see-the-fuzzers-successful-payload>tcpdump to see the fuzzer&rsquo;s successful payload</h4>
<p>I used <code>sudo tcpdump port 9999 -vv --interface eth1</code> to view the payloads sent by SPIKE.</p>
<p><img src=/images/2020-04-07-exploiting-vulnserver/tcpdump%209999.png alt></p>
<p>After the fuzzing, you should get a ****load of output from the <code>tcpdump</code> command. The last TCP sequence will be the
one that crashed vulnserver so that contains the beginning of a payload.</p>
<p><img src=/images/2020-04-07-exploiting-vulnserver/tcpdump-hex.png alt></p>
<p>You might be able to see the TRUN command in that buffer.</p>
<p>Note that the <code>.</code> character does not mean literally a PERIOD character, but it means either a space or non-printable
character, such as EOF or NUL character.</p>
<p>0x20, or 32, is the SPACE character.</p>
<p>The last command sent by SPIKE before vulnserver crashed was:</p>
<pre><code>5452 554e 202f 2e3a
2f41 4141 4141 4141
</code></pre>
<p>or,</p>
<pre><code>T R  U N    /  . :
/ A  A A  A A  A A
...
</code></pre>
<p>or,</p>
<pre><code>TRUN /.:/AAAAAAA...
</code></pre>
<p>The exact amount of &lsquo;A&rsquo; characters must be determined.</p>
<p>Before we do that using Python, let&rsquo;s take a look at the fuzzed payload in a different way.</p>
<h4 id=immunity-debugger-to-view-the-successfull-fuzzed-payload>Immunity Debugger to view the successfull fuzzed payload</h4>
<p>Alternatively, you can use Immunity Debugger to view the fuzzed payload.</p>
<ol>
<li>
<p>In Windows, start vulnserver as an admin by right-clicking on it. Do NOT use cmd.exe or powershell.exe to do this.</p>
</li>
<li>
<p>Then, start Immunity Debugger as an admin and attach it to the process. Make sure to resume the process as attaching
Immunity Debugger will pause it.</p>
</li>
<li>
<p>Finally, in Kali, fuzz the payload again.</p>
<p>Back in Windows, Immunity Debugger should have paused on an exception.</p>
</li>
</ol>
<p><img src=/images/2020-04-07-exploiting-vulnserver/immunity-trun-fuzz.png alt></p>
<p>You can see that the EAX register points to a buffer that contains our command.</p>
<p>Something very important here is that the ASCII <code>A</code> character&rsquo;s hexadecimal value is 0x41.</p>
<p>Look at the EIP register! We have filled it up with the <code>A</code> character from our payload!</p>
<p>We don&rsquo;t know <em>which exact location overwrites the EIP register</em> though. This is where Python comes in.</p>
<p>The EIP register stands for &lsquo;Extended Instruction Pointer&rsquo;. It is the memory location for the next command that the CPU
will execute. It will allow us to tell a program to execute instructions from anywhere in memory if we can control it.</p>
<p>In order to modify the EIP register reliably, we need to:</p>
<ul>
<li>Determine the rough length of the payload</li>
<li>Generate and inject a sequence of data that is unique for every 4 bytes of data
<ul>
<li>Generated with <code>pattern_create.rb</code></li>
<li>Then, look at the EIP register and determine the position of that 4-byte chunk of data found in the EIP register</li>
<li>This allows us to determine the EXACT position that data overflows into the EIP register</li>
</ul>
</li>
</ul>
<h3 id=python-fuzzing-script-pattern_createrb-pattern_offsetrb>Python fuzzing script, pattern_create.rb, pattern_offset.rb</h3>
<p>The next step was to create a Python script to get within about 1000 characters of the payload that crashes the server.</p>
<p>We don&rsquo;t need to be precise because as long as <em>any 4 bytes</em> of our payload is injected into the EIP register, we can
use the <code>pattern_offset.rb</code> tool to determine what position those 4 bytes were injected at.</p>
<h4 id=finding-the-rough-position-of-when-the-payload-gets-injected>Finding the rough position of when the payload gets injected</h4>
<p>options.py:</p>
<pre><code class=language-python>PORT = 9999
HOST = '192.168.33.16'
&lt;...&gt;
</code></pre>
<p>fuzz.py:</p>
<pre><code class=language-python>#!/usr/bin/env python2

&quot;&quot;&quot;
Determines the length of bytes necessary to trigger a buffer overflow in vulnserver
&quot;&quot;&quot;

import sys, socket
from time import sleep
from options import HOST, PORT

buffer = 'A' * 100

while True:
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((HOST, PORT))

        cmd = ('TRUN /.:/' + buffer)
        # print(&quot;SEND &quot;+cmd)
        s.send(cmd)
        print(&quot;sent %d bytes&quot; % len(buffer))
        s.close()
        sleep(1)

        buffer = buffer + (&quot;A&quot; * 100)
    except:
        print(&quot;crashed at %d bytes&quot; % len(buffer))
        # print(e)
        sys.exit()
</code></pre>
<p>This code is pretty simple.</p>
<p>It starts on line 11 with 100 <code>A</code> characters, and then from line 13-29 slowly increments the <code>A</code> characters by 100 until
either an exception is thrown or the server stops responding. Line 25 does the increment.</p>
<p>TODO show pics of it running and our length</p>
<h4 id=creating-a-pattern-that-is-unique-every-4-bytes>Creating a pattern that is unique every 4 bytes</h4>
<p>TODO explain <code>pattern_create.rb</code> and <code>determine_injection_position.py</code></p>
<p>TODO show the pattern being created</p>
<p>TODO show the pattern being sent</p>
<p>TODO show the pattern fragment in the EIP register</p>
<p>TODO show <code>pattern_offset.rb</code> showing us the exact position</p>
<h2 id=the-attack>The attack</h2>
<p>TODO: I am very busy with work and life and may not finish this post for a few months.</p>
<p>My source code all works AFAIK.</p>
<p>If this bothers you, just message my email and maybe I will get to it.</p>
<p>Alternatively, take the Udemy course yourself.</p>
<p>Please just run this file:</p>
<p><a href=https://github.com/HenryFBP/VagrantPackerFiles/blob/e6b73090ed23bda867f36a7f23951da6a54b55b6/vagrant/kali/shared/projects/vulnserver/shellcode-for-real-this-time.py>https://github.com/HenryFBP/VagrantPackerFiles/blob/e6b73090ed23bda867f36a7f23951da6a54b55b6/vagrant/kali/shared/projects/vulnserver/shellcode-for-real-this-time.py</a></p>
<p>And see these files for the payload and other options:</p>
<p><a href=https://github.com/HenryFBP/VagrantPackerFiles/blob/e6b73090ed23bda867f36a7f23951da6a54b55b6/vagrant/kali/shared/projects/vulnserver/options.py>https://github.com/HenryFBP/VagrantPackerFiles/blob/e6b73090ed23bda867f36a7f23951da6a54b55b6/vagrant/kali/shared/projects/vulnserver/options.py</a></p>
<p><a href=https://github.com/HenryFBP/VagrantPackerFiles/blob/e6b73090ed23bda867f36a7f23951da6a54b55b6/vagrant/kali/shared/projects/vulnserver/data/msfvenom-payload.dat>https://github.com/HenryFBP/VagrantPackerFiles/blob/e6b73090ed23bda867f36a7f23951da6a54b55b6/vagrant/kali/shared/projects/vulnserver/data/msfvenom-payload.dat</a></p>
</div>
<div class="flex flex-col md:flex-row md:justify-between -mx-2 mt-4 px-2 pt-4 border-t">
<div>
<span class="block font-bold">Previous</span>
<a href=/posts/2020-04-27-analyzing-document-based-malware-and-reverse-engineering-it/ class=block>Analyzing document-based malware and reverse engineering it</a>
</div>
<div class="md:text-right mt-4 md:mt-0">
</div>
</div>
</div>
<div class=col-span-2>
<div class="sticky top-16 z-10 hidden lg:block px-6 py-4 bg-primary-bg">
<span class="text-lg font-semibold">On This Page</span>
</div>
<div class="sticky-toc hidden lg:block px-6 pb-6">
<nav id=TableOfContents>
<ul>
<li><a href=#my-workcode>My work/code</a></li>
<li><a href=#the-course>The course</a></li>
<li><a href=#the-tools>The tools</a></li>
<li><a href=#setup>Setup</a></li>
<li><a href=#the-research>The research</a>
<ul>
<li><a href=#netcat>NetCat</a></li>
<li><a href=#spike>Spike</a>
<ul>
<li><a href=#tcpdump-to-see-the-fuzzers-successful-payload>tcpdump to see the fuzzer&rsquo;s successful payload</a></li>
<li><a href=#immunity-debugger-to-view-the-successfull-fuzzed-payload>Immunity Debugger to view the successfull fuzzed payload</a></li>
</ul>
</li>
<li><a href=#python-fuzzing-script-pattern_createrb-pattern_offsetrb>Python fuzzing script, pattern_create.rb, pattern_offset.rb</a>
<ul>
<li><a href=#finding-the-rough-position-of-when-the-payload-gets-injected>Finding the rough position of when the payload gets injected</a></li>
<li><a href=#creating-a-pattern-that-is-unique-every-4-bytes>Creating a pattern that is unique every 4 bytes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#the-attack>The attack</a></li>
</ul>
</nav>
</div>
<script>window.addEventListener('DOMContentLoaded',()=>{enableStickyToc()})</script>
</div>
</div>
<script>document.addEventListener('DOMContentLoaded',()=>{hljs.initHighlightingOnLoad()})</script>
</div>
</div>
</main>
<footer class=pl-scrollbar>
<div class="w-full max-w-screen-xl mx-auto"><div class="text-center p-6 pin-b">
<p class="text-sm text-tertiary-text">&copy; 2021 <a href=http://henrypost.net/>Henry Post</a>
&#183; Powered by the <a href=https://github.com/wangchucheng/hugo-eureka class=hover:text-eureka>Eureka</a> theme for <a href=https://gohugo.io class=hover:text-eureka>Hugo</a></p>
</div></div>
</footer>
</body>
</html>